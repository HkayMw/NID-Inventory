#:kivy 2.3.0
# view/sort_id/sort_id_view.kv



<SortIDScreen>:
    id: sort_id_view
    name: 'sort_id_view'
    orientation: "vertical"
    # space_x: self.size[0]/3
    # canvas.before:
    #     # Gray background
    #     Color:
    #         rgba: app.theme_cls.bg_light
    #         # rgba: (0.4, 0.4, 0.4, 1)
    #     Rectangle:
    #         size: self.size
    #         pos: self.pos
        

    BoxLayout:
        orientation: "vertical"
        height: self.minimum_height

        # Window Section
        MDBoxLayout:
            # adaptive_height: True
            md_bg_color: app.theme_cls.bg_light
            id: window_section
            name: "window_section"
            orientation: "vertical"
            padding: 0, 10
            # size_hint_y: .75
            height: self.minimum_height
            spacing: 40

            # Navigation
            BoxLayout:        
                orientation: "horizontal"
                padding: window_section.width*.167, .9
                pos_hint: {"center_x": 0.5, "center_y": 0.5}
                id: navigation
                size_hint_y: .1
                size_hint_x: .75
                spacing: 10

                #ADD ID Nav button
                BoxLayout:
                    size_hint_x: .5
                    pos_hint: {"center_x": 0.5, "center_y": 0.5}
                    padding: [5]
                    canvas.before:
                        Color:
                            rgba: (0.14, 0.31, 0.31, 1)  # Dark teal background
                        RoundedRectangle:
                            size: self.size
                            pos: self.pos
                            radius: [10, 10, 10, 10]  # Rounded corners

                    Button:
                        text: "Add IDs"
                        background_normal: ''
                        background_color: (0.14, 0.31, 0.31, 1)  # Dark teal color
                        size_hint_x: 1
                        font_size: min(self.width * .4, self.height * .4)
                        padding: [10, (self.height - self.line_height) / 2]
                        color:  1, 1, 1, 1  # White text
                        on_press: root.parent.current = 'add_id_view'


                #Search IDs Nav Button
                BoxLayout:
                    size_hint_x: .5
                    pos_hint: {"center_x": 0.5, "center_y": 0.5}
                    padding: [5]
                    canvas.before:
                        Color:
                            rgba: (0.14, 0.31, 0.31, 1)  # Dark teal background
                        RoundedRectangle:
                            size: self.size
                            pos: self.pos
                            radius: [10, 10, 10, 10]  # Rounded corners

                    Button:
                        text: "Search IDs"
                        background_normal: ''
                        background_color: (0.14, 0.31, 0.31, 1)  # Dark teal color
                        size_hint_x: 1
                        font_size: min(self.width * .4, self.height * .4)
                        padding: [10, (self.height - self.line_height) / 2]
                        color: 1, 1, 1, 1  # White text
                        on_press: root.parent.current = 'search_id_view'

                
                #Sort IDs Nav Button
                BoxLayout:
                    size_hint_x: .5
                    pos_hint: {"center_x": 0.5, "center_y": 0.5}
                    padding: [5]
                    canvas.before:
                        Color:
                            rgba: (0.7, 0.7, 0.7, 1)
                        RoundedRectangle:
                            size: self.size
                            pos: self.pos
                            radius: [10, 10, 10, 10]  # Rounded corners

                    Button:
                        text: "Sort IDs"
                        background_normal: ''
                        background_color: (0.7, 0.7, 0.7, 1)
                        size_hint_x: 1
                        font_size: min(self.width * .4, self.height * .4)
                        padding: [10, (self.height - self.line_height) / 2]
                        color: (0.14, 0.31, 0.31, 1)
                        on_press: root.parent.current = 'sort_id_view'

                #Contacts Nav Button
                BoxLayout:
                    size_hint_x: .5
                    pos_hint: {"center_x": 0.5, "center_y": 0.5}
                    padding: [5]
                    canvas.before:
                        Color:
                            rgba: (0.14, 0.31, 0.31, 1)  # Dark teal background
                        RoundedRectangle:
                            size: self.size
                            pos: self.pos
                            radius: [10, 10, 10, 10]  # Rounded corners

                    Button:
                        text: "Contacts"
                        background_normal: ''
                        background_color: (0.14, 0.31, 0.31, 1)  # Dark teal color
                        size_hint_x: 1
                        font_size: min(self.width * .4, self.height * .4)
                        padding: [10, (self.height - self.line_height) / 2]
                        color: 1, 1, 1, 1  # White text
                        on_press: root.parent.current = 'contact_view'

            # Main Section
            BoxLayout:
                orientation: "horizontal"
                id: main_section
                name: "main_section"
                size_hint_y: .9

                #Controls Section
                BoxLayout:
                    orientation: "vertical"
                    id: controls_section
                    name: "controls_section"
                    size_hint_x: .35
                    spacing: 20

                    Label:
                        size_hint_y:.1

                    # Letter To Sort Input
                    BoxLayout:
                        orientation: "horizontal"
                        id: sort_letter_container
                        name: "sort_letter_container"
                        size_hint_y: .15
                        size_hint_x: .9
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        # height: 50
                        padding: [5]
                        canvas.before:
                            Color:
                                rgba: (0.7, 0.7, 0.7, 1)  # Dark teal color
                            RoundedRectangle:
                                size: self.size
                                pos: self.pos
                                radius: [10, 10, 10, 10]  # Rounded corners

                        Label:
                            id:sort_later_label
                            text: "Pick a letter"
                            halign: "left"
                            valign: "middle"
                            text_size: self.size
                            size_hint_x: .7
                            color: (0.14, 0.31, 0.31, 1)
                            font_size: min(root.width * .04, root.height * .04)  # Adjust the multiplier as needed
                        
                        BoxLayout:
                            pos_hint: {'top': 1}
                            size_hint_x: .3
                            canvas.before:
                                Color:
                                    rgba: (0.14, 0.31, 0.31, 1)  # Dark teal background
                                RoundedRectangle:
                                    size: self.size
                                    pos: self.pos
                                    radius: [10, 10, 10, 10]  # Rounded corners

                            Spinner:
                                id: sort_letter
                                text: "ALL"
                                values: [chr(x) for x in range(65, 91)]  # Generates letters A to Z
                                # values: ["A", "", "B", "", "C", "", "D"]
                                # on_text: root.on_spinner_select(self, self.text)
                                foreground_color: (1, 1, 1, 1)  # Light gray text
                                background_color: (0, 0, 0, 0)  # Transparent to show canvas color
                                halign: 'center'
                                size: 200,44
                                # focus: True
                                multiline: False
                                font_size: min(self.width * .4, self.height * .4)
                                padding: [10, (self.height - self.line_height) / 2]

                                # Styling the dropdown items
                                option_cls: 'StyledSpinnerOption'
                                dropdown_cls: 'LimitedHeightDropDown'  # Use the custom dropdown
                    
                    Label:
                        size_hint_y:.15
                    
                    # From Date: For sorting Date Rage
                    BoxLayout:
                        orientation: "horizontal"
                        id: from_date_container
                        size_hint_y: .15
                        size_hint_x: .9
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        padding: [5]
                        halign: "left"
                        text_size: self.size
                        canvas.before:
                            Color:
                                rgba: (0.7, 0.7, 0.7, 1)  # Dark teal color
                            RoundedRectangle:
                                size: self.size
                                pos: self.pos
                                radius: [10, 10, 10, 10]  # Rounded corners

                        Label:
                            id:from_date_label
                            text: "From"
                            halign: "left"
                            valign: "middle"
                            text_size: self.size
                            color: (0.14, 0.31, 0.31, 1)
                            font_size: min(root.width * .04, root.height * .04)
                        
                        BoxLayout:
                            pos_hint: {'top': 1}
                            canvas.before:
                                Color:
                                    rgba: (0.14, 0.31, 0.31, 1)  # Dark teal background
                                RoundedRectangle:
                                    size: self.size
                                    pos: self.pos
                                    radius: [10, 10, 10, 10]  # Rounded corners

                            TextInput:
                                id: from_date
                                hint_text: "YYYY-MM-DD"
                                foreground_color: (0.7, 0.7, 0.7, 1)  # Light gray text
                                background_color: (0, 0, 0, 0)  # Transparent to show canvas color
                                halign: 'center'
                                focus: True
                                multiline: False
                                font_size: min(self.width * .4, self.height * .4)
                                padding: [10, (self.height - self.line_height) / 2]
                    
                    # To Date: For sorting Date Rage
                    BoxLayout:
                        orientation: "horizontal"
                        id: to_date_container
                        size_hint_y: .15
                        size_hint_x: .9
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        # height: 50
                        padding: [5]
                        canvas.before:
                            Color:
                                rgba: (0.7, 0.7, 0.7, 1)  # Dark teal color
                            RoundedRectangle:
                                size: self.size
                                pos: self.pos
                                radius: [10, 10, 10, 10]  # Rounded corners

                        Label:
                            id:to_date_label
                            text: "To"
                            text: "From"
                            halign: "left"
                            valign: "middle"
                            text_size: self.size
                            color: (0.14, 0.31, 0.31, 1)
                            font_size: min(root.width * .04, root.height * .04)
                        
                        BoxLayout:
                            pos_hint: {'top': 1}
                            canvas.before:
                                Color:
                                    rgba: (0.14, 0.31, 0.31, 1)  # Dark teal background
                                RoundedRectangle:
                                    size: self.size
                                    pos: self.pos
                                    radius: [10, 10, 10, 10]  # Rounded corners

                            TextInput:
                                id: to_date
                                hint_text: "YYYY-MM-DD"
                                foreground_color: (0.7, 0.7, 0.7, 1)  # Light gray text
                                background_color: (0, 0, 0, 0)  # Transparent to show canvas color
                                halign: 'center'
                                focus: True
                                multiline: False
                                font_size: min(self.width * .4, self.height * .4)
                                padding: [10, (self.height - self.line_height) / 2]
                    Label:
                        size_hint_y:.3
                #Search results Section
                BoxLayout:
                    orientation: 'vertical'
                    padding: 10
                    size_hint_x: .65

                    BoxLayout:
                        id: table_container
                        orientation: 'vertical'
                        padding: [10, 10, 10, 10]
                        size_hint_y: 1
                        # height: self.minimum_height

                        # MDDataTable:
                        #     id: id_results_table
                        #     size_hint_y: 1
                        #     size_hint_x: 1
                        #     pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                        #     column_data:
                        #         [("ID Number", dp(30)), ("First Name", dp(30)), ("Last Name", dp(30)), ("Date of Birth", dp(30)), ("Gender", dp(30))]
                        #     row_data: []

                        #     on_row_press:
                        #         app.on_row_press(*args)
            # Label:
            #     size_hint_y: .2
        
        



# Custom SpinnerOption class with padding
<StyledSpinnerOption@SpinnerOption>:
    background_color: (0, 0, 0, 0)  # Fully transparent default background
    canvas.before:
        Color:
            rgba: (0.14, 0.31, 0.31, 1)  # Dark teal background
        # RoundedRectangle:
        #     size: self.size
        #     pos: self.pos
        #     radius: [0, 0, 0, 0]  # Rounded corners
        Line:
            width:1.5
            rectangle: (self.x, self.y, self.width, self.height)
    color: (1, 1, 1, 1)  # Light gray text
    font_size: min(self.width * .4, self.height * .4)
    # padding: [20, 10]  # Increase padding: [horizontal padding, vertical padding]

<LimitedHeightDropDown@DropDown>:
    max_height: 120  # Limit the dropdown height to show only 3 items at a time